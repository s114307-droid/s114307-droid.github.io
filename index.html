<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>叢林裡的海獺</title>
  <style>
    body {
      margin: 0;
      background: #000;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    canvas {
      border: 2px solid #000;
    }
  </style>
</head>
<body>

<canvas id="game" width="900" height="550"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// 載入圖片
const bgImage = new Image();
bgImage.src = "images/jungle.jpg";

const otterImage = new Image();
otterImage.src = "images/otter.png";

// 河流設定
const river = {
  y: 260,
  height: 120
};

// 海獺
const otter = {
  x: 400,
  y: 290,
  width: 90,
  height: 60,
  speed: 4,
  floatOffset: 0
};

const keys = {};
window.addEventListener("keydown", e => keys[e.key] = true);
window.addEventListener("keyup", e => keys[e.key] = false);

function update() {
  if (keys["ArrowUp"]) otter.y -= otter.speed;
  if (keys["ArrowDown"]) otter.y += otter.speed;
  if (keys["ArrowLeft"]) otter.x -= otter.speed;
  if (keys["ArrowRight"]) otter.x += otter.speed;

  // 限制在河裡
  otter.x = Math.max(0, Math.min(canvas.width - otter.width, otter.x));
  otter.y = Math.max(
    river.y,
    Math.min(river.y + river.height - otter.height, otter.y)
  );

  // 游泳漂浮動畫
  otter.floatOffset += 0.05;
}

function draw() {
  // 背景
  ctx.drawImage(bgImage, 0, 0, canvas.width, canvas.height);

  // 河流
  ctx.fillStyle = "rgba(33, 150, 243, 0.35)";
  ctx.fillRect(0, river.y, canvas.width, river.height);

  // 波紋
  ctx.strokeStyle = "rgba(255,255,255,0.4)";
  for (let i = 0; i < 12; i++) {
    ctx.beginPath();
    ctx.moveTo(i * 80, river.y + 30);
    ctx.lineTo(i * 80 + 40, river.y + 50);
    ctx.stroke();
  }

  // 海獺（帶漂浮）
  const floatY = Math.sin(otter.floatOffset) * 4;
  ctx.drawImage(
    otterImage,
    otter.x,
    otter.y + floatY,
    otter.width,
    otter.height
  );
}

function gameLoop() {
  update();
  draw();
  requestAnimationFrame(gameLoop);
}

// 確保圖片載入完成再開始
let loaded = 0;
[bgImage, otterImage].forEach(img => {
  img.onload = () => {
    loaded++;
    if (loaded === 2) gameLoop();
  };
});
</script>

</body>
</html>
